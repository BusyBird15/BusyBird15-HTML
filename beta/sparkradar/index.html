<!--
Spark Radar
An online radar application for weather lovers.
Made by Tyler Granzow.
Programming of the Spark Radar project began in September 2024.
-->

<!DOCTYPE html>
<html>
<head>
    <!--Page title and icon-->
    <title>Spark Radar</title>
    <link rel="icon" type="image/png" href="logo-rounded.png">

    <!--Meta tags...-->
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <!--Links to the Leaflet CSS/JS-->
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    <link href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" rel="stylesheet"/>

    <!--Font links-->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cabin:ital,wght@0,400..700;1,400..700&display=swap" rel="stylesheet">

    <!--Icon set-->
    <script src="https://kit.fontawesome.com/3e2fc9ce5a.js" crossorigin="anonymous"></script>
    
    <!--CSS-->
    <link rel="stylesheet" href="style.css"></link>

    <!--MapTiler SDK-->
    <script src="https://cdn.maptiler.com/maptiler-sdk-js/v2.0.3/maptiler-sdk.umd.js"></script>
    <link href="https://cdn.maptiler.com/maptiler-sdk-js/v2.0.3/maptiler-sdk.css" rel="stylesheet" />
    <script src="https://cdn.maptiler.com/leaflet-maptilersdk/v2.0.0/leaflet-maptilersdk.js"></script>

</head>
<body>
    <!--Leaflet map-->
    <div id="map"></div>

    <!--Info-->
    <div id="attrib" class="overlay-object hidden" style="">

    </div>

    <!--Menu opener-->
    <button id="menu-opener" onclick="menuToggle(true);" class="hidden nav-btn overlay-object" style="background-color: rgba(0, 0, 0, 0.5); color: white; backdrop-filter: blur(3px); -webkit-backdrop-filter: blur(3px);">
        <i class="fa-solid fa-bars" style="font-size: 22px; color: white;"></i>
    </button>

    <!--Radar state info-->
    <div id="info" class="overlay-object" style="flex-direction: column; padding: 10px; display: flex; align-items: center; justify-content: center; width: calc(100% - 100px); max-width: 300px;">
        <p id="radinfo_lna" style="margin: 0px; font-size: large;"><b>CONUS â€¢ LATEST</b></p>
        <select id="prod" style="margin-top: 10px; font-size: medium;" onchange="setProduct();">
            <option value="conus_cref">Composite Reflectivity</option>
            <option value="conus_bref">Base Reflectivity</option>
        </select>
    </div>

    <!--Menu-->
    <div id="menu" class="hidden" style="z-index: 10; position: absolute; display: none !important; padding: 10px; flex-direction: column; left: 10px; top: 10px; width: calc(100% - 40px); max-width: 350px; height: calc(100% - 40px); border-radius: 10px; background-color: rgba(0, 0, 0, 0.5); backdrop-filter: blur(3px); -webkit-backdrop-filter: blur(3px);">
        <button id="menu-closer" onclick="menuToggle(false);" class="nav-btn" style="border-radius: 10px; background: #ff2121ff;">
            <i class="fa-solid fa-xmark" style="font-size: 16px; color: white;"></i>
        </button>
        <img src="logo.png" style="width: calc(100% - 20px); height: auto; border-radius: 10px; margin: 10px;">
        <br>
        <div style="overflow-y: auto; scrollbar-width: none;">
            <div onclick="dialog(true, 'settings');" class="menuitem"><i class="fa-solid fa-gear" style="color: #27bffff;"></i><b>Settings</b></div>
            <div onclick="dialog(true, 'appinfo');" class="menuitem"><i class="fa-solid fa-circle-info" style="color: #27bffff;"></i><b>About</b></div>
            <div onclick="dialog(true, 'about');" class="menuitem"><i class="fa-solid fa-circle-question" style="color: #27bffff;"></i><b>Technical Info</b></div>
            <a style="text-decoration: none;" target="_blank" href="https://github.com/BusyBird15/busybird15.github.io"><div class="menuitem"><i class="fa-brands fa-github" style="color: #27bffff;"></i><b>Github</b></div></a>
        </div>
    </div>

    <!--Dialog-->
    <div id="dialog" style="width: 100%; height: 100%; display: none; position: absolute; z-index: 15; justify-content: center; align-items: center; top: 0px; left: 0px; background: rgba(0, 0, 0, 0.1); backdrop-filter: blur(3px); -webkit-backdrop-filter: blur(3px);">
        <div style="overflow-y: auto; scrollbar-width: none; padding: 10px; width: 100%; height: 100%; max-width: 500px; max-height: 500px; margin: 10px; border-radius: 10px; background: black; color: white; box-shadow: #0000008c 3px 3px 9px 0px;">
            <button id="dialog-closer" onclick="dialog(false);" class="nav-btn" style="background: #ff2121ff; border-radius: 10px;">
                <i class="fa-solid fa-xmark" style="font-size: 16px; color: white;"></i>
            </button><br>

            <div id="settings" style="display: flex; flex-direction: column; overflow-x: hide;">
                <hr style="width: 100%; margin-top: 10px;">
                <div style="display: flex; justify-content: space-around;">
                    <button id="settings-general" onclick="settingsmode('settmenu-general', 'settings-general');" class="set-btn" style="background: #27beffff; border-radius: 10px;">
                        <i class="fa-solid fa-gear" style="font-size: 16px;"></i>
                    </button>
                    <button id="settings-map" onclick="settingsmode('settmenu-map', 'settings-map');" class="set-btn" style="background: #89999f; border-radius: 10px;">
                        <i class="fa-solid fa-map" style="font-size: 16px;"></i>
                    </button>
                    <button id="settings-radar" onclick="settingsmode('settmenu-radar', 'settings-radar');" class="set-btn" style="background: #89999f; border-radius: 10px;">
                        <i class="fa-solid fa-satellite-dish" style="font-size: 16px"></i>
                    </button>
                    <button id="settings-alerts" onclick="settingsmode('settmenu-alerts', 'settings-alerts');" class="set-btn" style="background: #89999f; border-radius: 10px;">
                        <i class="fa-solid fa-triangle-exclamation" style="font-size: 16px;"></i>
                    </button>
                </div>
                <hr style="margin-bottom: 10px; width: 100%;">

                <div id="settmenu-general" style="flex-direction: column; display: flex;">
                    <p style="margin: 10px 5px 5px 5px; font-size: large;"><i class="fa-solid fa-bugs setticon" style="font-size: 16px; color: white;"></i><b>JS Information</b></p>
                    <p style="margin: 5px 5px 10px 5px; font-size: medium;">The info appears in the bottom left corner and reveals what the radar is doing.</p>
                    <label style="margin-left: 20px; font-size: medium;" class="checkbox-container">
                        <input type="checkbox" id="debugger" onchange="if (document.getElementById('debugger').checked) { document.getElementById('infop').style.display = 'flex' } else { document.getElementById('infop').style.display = 'none' }">
                        <span class="checkmark" style="margin-right: 10px;"></span>
                        Show debugger
                    </label>
                </div>

                <div id="settmenu-map" style="flex-direction: column; display: none;">
                    <p style="margin: 10px 5px 10px 5px; font-size: large;"><i class="fa-solid fa-map setticon" style="font-size: 16px; color: white;"></i><b>Map Style</b></p>
                    <label style="margin-left: 20px; margin-bottom: 10px; font-size: medium;" class="checkbox-container">
                        <input type="checkbox" id="defaultmp" onchange="setMapType('defaultmp', map_default)">
                        <span class="checkmark" style="margin-right: 10px;"></span>
                        <p style="font-size: medium; margin: 0px;"><b>MapTiler's</b> Basic (default)</p>
                    </label>
                    <label style="margin-left: 20px; margin-bottom: 10px; font-size: medium;" class="checkbox-container">
                        <input type="checkbox" id="streetsmp" onchange="setMapType('streetsmp', map_streets)">
                        <span class="checkmark" style="margin-right: 10px;"></span>
                        <p style="font-size: medium; margin: 0px;"><b>MapTiler's</b> Streets</p>
                    </label>
                    <label style="margin-left: 20px; margin-bottom: 10px; font-size: medium;" class="checkbox-container">
                        <input type="checkbox" id="darkmattermp" onchange="setMapType('darkmattermp', map_darkmatter)">
                        <span class="checkmark" style="margin-right: 10px;"></span>
                        <p style="font-size: medium; margin: 0px;"><b>CartoDB's</b> Dark Matter</p>
                    </label>
                    <label style="margin-left: 20px; margin-bottom: 10px; font-size: medium;" class="checkbox-container">
                        <input type="checkbox" id="lightmattermp" onchange="setMapType('lightmattermp', map_lightmatter)">
                        <span class="checkmark" style="margin-right: 10px;"></span>
                        <p style="font-size: medium; margin: 0px;"><b>CartoDB's</b> Light Matter</p>
                    </label>
                </div>

                 <div id="settmenu-radar" style="flex-direction: column; display: none;">
                     <p style="margin: 10px 5px 5px 5px; font-size: large;"><i class="fa-solid fa-star setticon" style="font-size: 16px; color: white;"></i><b>Radar resolution</b></p>
                     <p style="margin: 5px 5px 10px 5px; font-size: medium;">A higher resolution provides a more crisp radar image but uses more data and may cause the radar to lag or load slower.</p>
                     <select id="res" onchange="setResolution();">
                        <option value="1">Maximum</option>
                        <option value="1.5">Great</option>
                        <option value="2">Good (Recommended)</option>
                        <option value="3">Fair</option>
                        <option value="4">Data saver</option>
                        <option value="5">Minimum</option>
                     </select>
                     <p style="margin: 30px 5px 5px 5px; font-size: large;"><i class="fa-solid fa-eye setticon" style="font-size: 16px; color: white;"></i><b>Radar opacity</b></p>
                     <p style="margin: 5px 5px 10px 5px; font-size: medium;">A higher opacity value means a less transparent radar.</p>
                     <input style="width: calc(100% - 10px);" type="range" min="1" max="100" value="75" class="slider" id="radop" onchange="radarOpacityChange()" title="Radar Opacity">
                 </div>

                <div id="settmenu-alerts" style="flex-direction: column; display: none;">
                    <p style="margin: 10px 5px 5px 5px; font-size: large;"><i class="fa-solid fa-cloud-bolt setticon" style="font-size: 16px; color: white;"></i><b>SPC Watches</b></p>
                    <p style="margin: 5px 5px 10px 5px; font-size: medium;">Show or hide severe thunderstorm and tornado watches issued by the SPC.</p>
                    <label style="margin-left: 20px; font-size: medium;" class="checkbox-container">
                        <input type="checkbox" checked="true" id="wwtoggle" onchange="watchesEnabled = document.getElementById('wwtoggle').checked; if (watchesEnabled) { loadWatches(); } else { watches.clearLayers(); }">
                        <span class="checkmark" style="margin-right: 10px;"></span>
                        Show watches
                    </label>
                 </div>
            </div>

            <div id="appinfo" style="align-items: center; overflow-y: hidden; display: none; scrollbar-width: narrow; flex-direction: column;">
                <p style="margin: 10px 5px 5px 5px; font-size: large;"><b>ðŸ‘‹ Hi there!</b></p>
                <p style="margin: 5px 5px 10px 5px; font-size: medium;">Thanks for checking out my radar. Spark Radar was a project I started in 2024 because I love tracking the weather and programming. I made the entire thing open source because finding the radar data was really hard to do. You can check out the source code in <a class="credit" href="https://github.com/BusyBird15/busybird15.github.io/">this repo</a>.</p>
                <p style="margin: 20px 5px 5px 5px; font-size: large;"><b>How does it work?</b></p>
                <p style="margin: 5px 5px 10px 5px; font-size: medium;">The principle of Spark Radar is actually very simple. I found a tile server used by the NWS's radar. After passing it a bounding box and station, it returns an image which simply gets placed on the map!</p>
                <p style="margin: 20px 5px 5px 5px; font-size: large;"><b>Credits</b></p>
                <p style="margin: 5px 5px 10px 5px; font-size: medium;">The following are the services and sources which the radar gets data from:</p>
                <p style="margin: 5px 5px 10px 15px; font-size: medium; width: calc(100% - 40px); text-align: left;"><b>Radar Images: </b><a href="https://opengeo.ncep.noaa.gov" target="_blank" class="credit">NOAA's OPENGEO Server</a><br>
                    <b>Radar Info and Stations:</b> <a href="https://www.weather.gov/documentation/services-web-api#/" target="_blank" class="credit">NWS API</a><br>
                    <b>Alerts:</b> <a href="https://www.weather.gov/documentation/services-web-api#/" target="_blank" class="credit">NWS API</a><br>
                    <b>Watches:</b> <a href="https://www.mesonet.agron.iastate.edu/request/gis/spc_watch.phtml" target="_blank" class="credit">The IEM WW Archive</a><br>
                    <b>SPC Outlooks:</b> <a href="https://www.spc.noaa.gov/products/outlook/day1otlk_cat.nolyr.geojson" target="_blank" class="credit">NWS SPC GeoJSON</a><br>
                    <b>Search Results:</b> <a href="https://geocode.maps.co" target="_blank" class="credit">Geocode</a><br>
                </p>
                <p style="margin: 20px 5px 5px 5px; font-size: large;"><b>Honorable Mentions</b></p>
                <p style="margin: 5px 5px 10px 5px; font-size: medium;">The following people have helped make the radar or have helped me with finding data:</p>
                <p style="margin: 5px 5px 10px 15px; font-size: medium; width: calc(100% - 40px); text-align: left;"><b>SteepAtticStairs</b> (Creator of AtticRadar)<br><b>Dan Paulat</b> (Creator of SupercellWX)<br><b>Wxtership</b> (Owner of Xtreme Weather Discord)</p>
            </div>

            <div id="about" style="align-items: center; overflow-y: hidden; display: none; scrollbar-width: narrow; flex-direction: column;">
                <p style="margin: 10px 5px 5px 5px; font-size: large;"><b>Version:</b> BETA v0.4</p>
                <p style="margin: 10px 5px 5px 5px; font-size: large;"><b>Date:</b> Oct. 9, 2024</p>
            </div>

            <div id="alertinfo" style="font-family: Consolas; overflow-y: hidden; display: none; scrollbar-width: narrow; flex-direction: column;">
            </div>
        </div>
    </div>

    <!--Location Finder-->
    <div class="overlay-object" id="searchbox" style="padding: 0px; display: flex; top: 10px; left: 70px; width: calc(100% - 500px); max-width: 350px; min-width: 200px; z-index: 4;">
        <button onclick="document.getElementById('results').style.display = 'none'; document.getElementById('textbox').value = '';" class="searchbuttons" style="padding: 5px 0px 5px 5px;"><i class="fa-solid fa-xmark" style="font-size: 16px; margin: 5px; color: white;"></i></button>
        <input type="text" placeholder="Find a place" id="textbox" style="transition-duration: 0.3s; font-size: 16px; color: white; background: rgba(255, 255, 255, 0.2); padding: 5px; margin: 5px; border: none; width: 100%; border-radius: 7px;">
        <button id="searchbtn" class="searchbuttons" style="padding: 5px 5px 5px 0px;" onclick="doLocSearch(document.getElementById('textbox').value);"><i class="fa-solid fa-search" style="font-size: 16px; margin: 5px; color: white;"></i></button>
    </div>
    <div id="results" class="overlay-object" style="width: calc(100% - 520px); flex-direction: column; max-width: 330px; min-width: 180px; left: 70px; top: 60px; overflow-x: auto; height: calc(100% - 400px); min-height: 200px; max-height: 300px; scrollbar-width: none; padding: 10px;"></div>

    <p id="infop" style="display: none; transition-duration: 0.2s; z-index: 100; margin: 0px; text-size: large; bottom: 10px; left: 10px; position: absolute; color: black;">Loading radar...</p>
</body>

<!--Add JS after elements are added-->
<script src="script.js"></script>

</html>